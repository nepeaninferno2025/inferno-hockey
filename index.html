<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Inferno Nepean Hockey</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="assets/inferno-logo.png" type="image/png">

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getDatabase, ref, set, onValue, remove } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";

const firebaseConfig = {
  apiKey:"AIzaSyCcl7fjelmFRMSNqrNfCTSEJxJcxj7lano",
  databaseURL:"https://infernohockey-b39f9-default-rtdb.firebaseio.com",
  projectId:"infernohockey-b39f9"
};
window.app = initializeApp(firebaseConfig);
window.db = getDatabase(window.app);
</script>

<style>
:root{
  --dark:#0c0c0c;
  --card:#171717;
  --accent:#ff4500;
  --text:#f2f2f2;
  --highlight:#ff7a3d;
}
*{box-sizing:border-box;}
body{margin:0;font-family:"Segoe UI",Arial,sans-serif;background:var(--dark);color:var(--text);}
header{background:linear-gradient(90deg,#8b0000,#ff4500);padding:10px 20px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;}
.brand{display:flex;gap:12px;align-items:center;}
.brand img{height:60px;}
.brand span{font-size:14px;color:#ffe1e1;}
nav{display:flex;gap:12px;align-items:center;flex-wrap:wrap;}
nav a{color:#fff;font-weight:600;cursor:pointer;text-decoration:none;font-size:14px;}
nav a.admin{border:1px solid #fff;padding:5px 12px;border-radius:20px;}
nav a.logout{border:1px solid #ff4500;color:#ff4500;padding:5px 12px;border-radius:20px;display:none;}

.banner{
  background:#111;
  height:30px;
  overflow:hidden;
  border-radius:8px;
  width:100%;
  margin-top:10px;
}
.banner span{
  display:inline-block;
  white-space:nowrap;
  font-weight:700;
  font-size:14px;
  padding-left:100%;
  animation:scroll 22s linear infinite;
}
@keyframes scroll{
  from{transform:translateX(0);}
  to{transform:translateX(-100%);}
}

main{max-width:1200px;margin:auto;padding:20px;}
section{display:none;}
section.active{display:block;}
.card{background:var(--card);padding:20px;border-radius:12px;box-shadow:0 10px 25px rgba(0,0,0,.5);margin-bottom:20px;}
h2{margin-top:0;border-left:6px solid var(--accent);padding-left:10px;}
table{width:100%;border-collapse:collapse;margin-top:15px;}
th,td{border:1px solid #2a2a2a;padding:8px;text-align:center;}
th{background:#111;color:var(--accent);}
.admin-only{display:none;}
textarea,input,button{width:100%;margin-top:10px;padding:8px;border-radius:6px;border:none;}
textarea,input{background:#0f0f0f;color:#fff;}
button{background:var(--accent);font-weight:700;cursor:pointer;}
.action-btn{padding:3px 6px;margin:0 2px;border:none;border-radius:6px;cursor:pointer;}
.edit-btn{background:orange;color:#000;}
.delete-btn{background:red;color:#fff;}
.save-btn{background:green;color:#fff;}
.cancel-btn{background:#888;color:#fff;}
.team-record{text-align:center;margin-bottom:20px;}
.record-score{font-size:32px;color:#ff0000;font-weight:900;}
.countdown{text-align:center;font-size:14px;margin-top:4px;}
</style>
</head>

<body>

<header>
  <div class="brand">
    <img src="assets/inferno-logo.png">
    <div>
      <h1>Inferno Nepean Hockey</h1>
      <span>Loyalty â€¢ Trust â€¢ Commitment</span>
    </div>
  </div>

  <nav>
    <a onclick="show('roster')">Roster</a>
    <a onclick="show('league')">League</a>
    <a onclick="show('coaches')">Coaches</a>
    <a onclick="show('schedule')">Schedule & Results</a>
    <a onclick="show('news')">News</a>
    <a onclick="show('record')">Team Record</a>
    <a class="admin" onclick="show('admin')">Admin</a>
    <a class="logout" id="logoutBtn" onclick="logout()">Logout</a>
  </nav>

  <div class="banner">
    <span id="bannerText">Loading updatesâ€¦</span>
  </div>
</header>

<main>
<section id="record">
  <div class="card">
    <h2>Team Record</h2>
    <div class="team-record">
      <div class="record-score" id="recordText">0 - 0 - 0</div>
      <textarea id="recordInput" class="admin-only" placeholder="W - L - T"></textarea>
      <button class="admin-only" onclick="saveRecord()">Save Record</button>
    </div>
  </div>
</section>

<section id="admin">
  <div class="card">
    <h2>Admin Login</h2>
    <input id="user" placeholder="Username">
    <input id="pass" type="password" placeholder="Password">
    <button onclick="login()">Login</button>
  </div>
</section>
</main>

<script type="module">
import { ref, set, onValue, remove } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";
const db = window.db;

const ADMIN_USER="athenadmin";
const ADMIN_PASS="AthFon32";
let isAdmin=false;

window.show=id=>{
  document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
};

window.login=()=>{
  if(user.value!==ADMIN_USER||pass.value!==ADMIN_PASS) return alert("Incorrect login");
  isAdmin=true;
  document.querySelectorAll(".admin-only").forEach(e=>e.style.display="block");
  logoutBtn.style.display="inline-block";
};

window.logout=()=>{
  isAdmin=false;
  document.querySelectorAll(".admin-only").forEach(e=>e.style.display="none");
  logoutBtn.style.display="none";
};

function saveRecord(){
  if(!isAdmin) return;
  const val=document.getElementById("recordInput").value.trim();
  if(!val) return;
  set(ref(db,"record"),val);
  document.getElementById("recordInput").value="";
}

/* âœ… FIXED RECORD LOADER */
onValue(ref(db,"record"), snap=>{
  document.getElementById("recordText").textContent = snap.val() || "0 - 0 - 0";
});

/* âœ… FIXED BANNER */
function updateBanner(){
  let text="ðŸ”¥ ";
  onValue(ref(db,"schedule"), s=>{
    const games=s.val()||{};
    Object.values(games).forEach(v=>{
      const g=v.split("|");
      text+=`${g[0]} vs ${g[1]} â€¢ `;
    });
    onValue(ref(db,"news"), n=>{
      const news=n.val()||{};
      Object.values(news).forEach(v=>{
        const item=v.split("|");
        text+=`${item[0]} â€¢ `;
      });
      document.getElementById("bannerText").textContent=text;
    });
  });
}
updateBanner();

document.addEventListener("DOMContentLoaded",()=>show("record"));
</script>

</body>
</html>
