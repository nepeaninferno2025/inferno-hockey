<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inferno Nepean Hockey</title>

<style>
body{margin:0;font-family:Arial;background:#0f0f0f;color:#f5f5f5}
header{background:linear-gradient(90deg,#b30000,#ff4500);padding:20px;display:flex;flex-wrap:wrap;align-items:center;gap:20px}
header img{height:80px;cursor:pointer}
nav{display:flex;flex-wrap:wrap;gap:15px}
nav a{color:white;text-decoration:none;font-weight:bold;cursor:pointer}
nav a:hover{text-decoration:underline}
section{padding:40px 20px;max-width:1200px;margin:auto}
h2{border-left:5px solid #ff4500;padding-left:12px}
h3{border-left:4px solid #ff4500;padding-left:10px;margin-top:30px}
.card{background:#1a1a1a;padding:20px;border-radius:14px;margin-bottom:25px}
input,textarea,select,button{padding:8px;margin:5px;border-radius:6px;border:none}
textarea{width:100%}
button{background:#ff4500;color:black;font-weight:bold;cursor:pointer}
button:hover{opacity:.9}
table{width:100%;border-collapse:collapse;margin-top:15px;min-width:350px}
th,td{padding:10px;border-bottom:1px solid #333}
th{background:#222}
.admin-only{display:none}
.page{display:none}
.page.active{display:block}
.table-wrap{overflow-x:auto}
#loginOverlay{position:fixed;inset:0;background:#0f0f0f;display:flex;align-items:center;justify-content:center;flex-direction:column;z-index:9999}
#logoutBtn{display:none}
@media(max-width:700px){header{flex-direction:column}nav{justify-content:center}input,select,button{width:100%}}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginOverlay">
<h2>Inferno Team Login</h2>
<input type="password" id="memberPass" placeholder="Team Password">
<button onclick="memberLogin()">Enter as Member</button>
<hr style="width:240px;margin:20px">
<h3>Admin Login</h3>
<input id="adminUser" placeholder="Admin Username">
<input type="password" id="adminPass" placeholder="Admin Password">
<button onclick="adminLogin()">Admin Login</button>
<h4>Create Admin</h4>
<input id="newAdminUser" placeholder="New Admin Username">
<input type="password" id="newAdminPass" placeholder="New Admin Password">
<input id="adminKey" placeholder="Admin Key">
<button onclick="createAdmin()">Create Admin</button>
</div>

<header>
<img id="logoImg" src="" alt="Inferno Logo">
<nav>
<a onclick="showPage('about')">About</a>
<a onclick="showPage('news')">News</a>
<a onclick="showPage('roster')">Roster</a>
<a onclick="showPage('stats')">Player Stats</a>
<a onclick="showPage('league')">League Stats</a>
<a onclick="showPage('videos')">Videos</a>
<a onclick="showPage('coaches')">Coaches</a>
</nav>
<button id="logoutBtn" onclick="logout()">Logout</button>
</header>

<section class="admin-only">
<input type="file" id="logoUpload" accept="image/*">
<button onclick="updateLogoPublic()">Change Logo</button>
</section>

<!-- ABOUT -->
<section id="about" class="page">
<h2>About</h2>
<div class="card">
<textarea id="aboutInput" class="admin-only" placeholder="Enter team info"></textarea>
<button class="admin-only" onclick="saveAbout()">Save</button>
<p id="aboutText"></p>
</div>
</section>

<!-- NEWS -->
<section id="news" class="page">
<h2>Team News</h2>
<div class="card">
<div class="admin-only">
<input id="newsTitle" placeholder="Title">
<textarea id="newsText" placeholder="News content"></textarea>
<input type="file" id="newsImage">
<button onclick="addNews()">Post News</button>
</div>
<div id="newsFeed"></div>
</div>
</section>

<!-- ROSTER -->
<section id="roster" class="page">
<h2>Team Roster</h2>
<div class="card">
<form id="rosterForm" class="admin-only">
<input placeholder="Player Name" required>
<select required>
  <option value="">Group</option>
  <option value="F">Forward</option>
  <option value="D">Defense</option>
  <option value="G">Goalie</option>
</select>
<select required>
  <option value="">Position</option>
  <option value="Center">Center</option>
  <option value="Left Wing">Left Wing</option>
  <option value="Right Wing">Right Wing</option>
  <option value="Defense">Defense</option>
  <option value="Goalie">Goalie</option>
</select>
<input placeholder="Jersey #" required>
<button>Add Player</button>
</form>

<h3>Forwards</h3>
<div class="table-wrap"><table><thead><tr><th>Name</th><th>Position</th><th>#</th><th class="admin-only">Actions</th></tr></thead><tbody id="rosterF"></tbody></table></div>

<h3>Defense</h3>
<div class="table-wrap"><table><thead><tr><th>Name</th><th>Position</th><th>#</th><th class="admin-only">Actions</th></tr></thead><tbody id="rosterD"></tbody></table></div>

<h3>Goalies</h3>
<div class="table-wrap"><table><thead><tr><th>Name</th><th>Position</th><th>#</th><th class="admin-only">Actions</th></tr></thead><tbody id="rosterG"></tbody></table></div>
</div>
</section>

<!-- STATS, LEAGUE, VIDEOS, COACHES -->
<section id="stats" class="page"><h2>Player Stats</h2><div id="statsContent" class="card"></div></section>
<section id="league" class="page"><h2>League Standings</h2><div id="leagueContent" class="card"></div></section>
<section id="videos" class="page"><h2>Videos</h2><div id="videosContent" class="card"></div></section>
<section id="coaches" class="page"><h2>Coaches</h2><div id="coachesContent" class="card"></div></section>

<footer>Inferno Nepean Hockey ¬© 2025</footer>

<script type="module">
// Firebase modules
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-analytics.js";
import { getDatabase, ref, set, get, onValue, push } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyCcl7fjelmFRMSNqrNfCTSEJxJcxj7lano",
  authDomain: "infernohockey-b39f9.firebaseapp.com",
  databaseURL: "https://infernohockey-b39f9-default-rtdb.firebaseio.com",
  projectId: "infernohockey-b39f9",
  storageBucket: "infernohockey-b39f9.appspot.com",
  messagingSenderId: "930315123046",
  appId: "1:930315123046:web:46e46a558e380e8180f0a7",
  measurementId: "G-EWC77NYL5F"
};

const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
const db = getDatabase(app);

// Admin/member
const MEMBER_PASSWORD="INferno12831";
const ADMIN_KEY="88123612";
let admins=JSON.parse(localStorage.admins||'[]');
const logoImg=document.getElementById("logoImg");

// Load logo
onValue(ref(db,'logo'), snapshot => {
  logoImg.src = snapshot.val() || "";
});

// Upload logo to Firebase + Cloudinary
async function updateLogoPublic(){
  const file = document.getElementById("logoUpload").files[0];
  if(!file) return alert("Select a file");
  const formData = new FormData();
  formData.append("file", file);
  formData.append("upload_preset", "YOUR_UPLOAD_PRESET"); // Replace with your Cloudinary preset
  const res = await fetch("https://api.cloudinary.com/v1_1/YOUR_CLOUD_NAME/image/upload", { method:"POST", body:formData });
  const data = await res.json();
  logoImg.src = data.secure_url;
  set(ref(db,'logo'), data.secure_url);
  alert("Logo updated publicly!");
}

// Admin/member login functions
function memberLogin(){if(memberPass.value!==MEMBER_PASSWORD)return alert("Wrong password");loginOverlay.style.display="none";logoutBtn.style.display="block";showPage("about");}
function adminLogin(){if(!admins.find(a=>a.username===adminUser.value&&a.password===adminPass.value))return alert("Invalid admin");document.querySelectorAll(".admin-only").forEach(e=>e.style.display="block");loginOverlay.style.display="none";logoutBtn.style.display="block";showPage("about");}
function createAdmin(){if(adminKey.value!==ADMIN_KEY)return alert("Wrong key");admins.push({username:newAdminUser.value,password:newAdminPass.value});localStorage.admins=JSON.stringify(admins);alert("Admin created");}
function logout(){location.reload();}
function showPage(id){document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));document.getElementById(id).classList.add("active");}

// ROSTER
const rosterF=document.getElementById("rosterF");
const rosterD=document.getElementById("rosterD");
const rosterG=document.getElementById("rosterG");

function addRosterRow(p){
  const tr=document.createElement("tr");
  tr.innerHTML=`<td>${p.name}</td><td>${p.position}</td><td>${p.num}</td>
  <td class="admin-only">
    <button onclick="editRoster(this)">Edit</button>
    <button onclick="deleteRoster(this)">üóëÔ∏è</button>
  </td>`;
  (p.group==="F"?rosterF:p.group==="D"?rosterD:rosterG).appendChild(tr);
}

function saveRosterPublic(){
  const collect=(t,g)=>[...t.rows].map(r=>({name:r.cells[0].textContent,position:r.cells[1].textContent,num:r.cells[2].textContent,group:g}));
  set(ref(db,'roster'),[...collect(rosterF,"F"),...collect(rosterD,"D"),...collect(rosterG,"G")]);
}

onValue(ref(db,'roster'), snapshot => {
  const data = snapshot.val()||[];
  [rosterF, rosterD, rosterG].forEach(t=>t.innerHTML='');
  data.forEach(addRosterRow);
});

function editRoster(b){
  const r=b.parentElement.parentElement;
  if(b.textContent==="Edit"){
    r.cells[0].innerHTML=`<input value="${r.cells[0].textContent}">`;
    r.cells[1].innerHTML=`<input value="${r.cells[1].textContent}">`;
    r.cells[2].innerHTML=`<input value="${r.cells[2].textContent}">`;
    b.textContent="Save";
  } else {
    r.cells[0].textContent=r.cells[0].querySelector("input").value;
    r.cells[1].textContent=r.cells[1].querySelector("input").value;
    r.cells[2].textContent=r.cells[2].querySelector("input").value;
    b.textContent="Edit";
    saveRosterPublic();
  }
}

function deleteRoster(b){b.parentElement.parentElement.remove();saveRosterPublic();}

document.getElementById("rosterForm").onsubmit=e=>{
  e.preventDefault();
  const [n,g,pos,num]=[e.target[0].value,e.target[1].value,e.target[2].value,e.target[3].value];
  addRosterRow({name:n,group:g,position:pos,num});
  saveRosterPublic();
  e.target.reset();
};

// Expose functions globally
window.showPage = showPage;
window.memberLogin = memberLogin;
window.adminLogin = adminLogin;
window.createAdmin = createAdmin;
window.logout = logout;
window.updateLogoPublic = updateLogoPublic;
window.editRoster = editRoster;
window.deleteRoster = deleteRoster;

// Show About page by default
showPage('about');
</script>

</body>
</html>


